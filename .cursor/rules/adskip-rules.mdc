---
description: 处理广告识别插件的避坑指令
globs: 
alwaysApply: false
---
# 广告识别插件开发规则

1. 除了options和popup外，其他所有模块禁止使用对DOMContentLoaded的document.addEventListener

2. 除非有明确的指示，否则不要试图修改任何内部方法的接口

3. 在做修改前充分了解 \chrome_plugin\docs\module_analysis里的各模块技术文档，遵循模块分工的最佳实践，并在验收通过后把修改同步更新到技术文档中，DRY原则非常重要！

4. 代码应当遵循"最小必要性"原则，尤其是减少对内部代码和版本的兼容，不要考虑稳定性，除非是外部API的调用，否则不要草率的添加无用的try，这个业务只有100%可用的情况可以接受。协助我验证准确可靠的解决方案。

5. **验证分层原则**：
   - UI层负责全面验证用户输入
   - 只在外部API调用处进行错误处理
   - 内部模块间调用优先信任，避免重复验证
   - 当处理外部数据时才进行完整验证

6. **代码简洁策略**：
   - 消除不会触发的防御性检查
   - 在处理异常值时使用默认值而非复杂条件判断
   - 对可能的错误场景统一使用简洁的解决方案
   - 避免冗余的日志输出，确保每条日志都提供有价值信息。特别的，对于当前开发中的涉及到的日志，在内容最前面额外加上一个临时标记🌟🌟🌟，这个标记回头我会在验收完成后手动删掉

7. **单人项目代码管理**：
   - 模块间共享函数应集中管理，避免重复实现
   - 新功能实现前评估对现有模块的影响
   - 配置处理与业务逻辑解耦
   - 通过明确的数据流减少状态同步复杂度

8. **可靠性确保方法**：
   - "可靠"定义为行为可预测，而非过度防御
   - 优先使用合理的默认值处理异常情况
   - 错误处理集中于真正可能失败的环节
   - Chrome API调用必须处理lastError
   - 内部函数间调用假设输入已验证，专注业务逻辑